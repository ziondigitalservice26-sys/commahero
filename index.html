<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="google-adsense-account" content="ca-pub-7866704248064211">
  <title>CommaHero ‚Äî Column to Delimited List Converter | SQL, CSV, Array ¬∑ Free &amp; Online</title>
  <meta name="description" content="CommaHero: Convert any column of text into a delimited list for SQL IN, CSV, JavaScript Array and more. Free, online, no signup, 100% in your browser." />
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7866704248064211"
     crossorigin="anonymous"></script>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.82em' font-size='72' font-family='serif'>:)</text></svg>" />
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;600;700&family=Syne:wght@400;600;700;800&display=swap" rel="stylesheet" />

  <style>
    /* =====================================================
       CSS VARIABLES & RESET
    ===================================================== */
    :root {
      --bg:           #0f1117;
      --bg-panel:     #161a23;
      --bg-card:      #1c2130;
      --bg-input:     #111520;
      --border:       #2a3149;
      --border-light: #3a4460;
      --accent:       #f5a623;
      --accent-dim:   #c47d0e;
      --accent-glow:  rgba(245,166,35,0.15);
      --green:        #3ddc84;
      --red:          #ff5c5c;
      --blue:         #5b9bd5;
      --text:         #e8eaf2;
      --text-dim:     #8892a4;
      --text-muted:   #555f75;
      --radius:       8px;
      --radius-lg:    12px;
      --font-mono:    'JetBrains Mono', 'Consolas', 'Monaco', monospace;
      --font-ui:      'Syne', sans-serif;
      --shadow:       0 4px 24px rgba(0,0,0,0.4);
      --transition:   0.18s ease;
    }
    [data-theme="light"] {
      --bg:           #f0f2f7;
      --bg-panel:     #e4e8f0;
      --bg-card:      #ffffff;
      --bg-input:     #f8f9fc;
      --border:       #d0d6e4;
      --border-light: #bcc4d6;
      --accent:       #d4870a;
      --accent-dim:   #b06a00;
      --accent-glow:  rgba(212,135,10,0.12);
      --green:        #1a9458;
      --red:          #d93535;
      --blue:         #2a6db5;
      --text:         #1a1e2e;
      --text-dim:     #4a5470;
      --text-muted:   #8892a4;
      --shadow:       0 4px 24px rgba(0,0,0,0.1);
    }

    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    html { scroll-behavior: smooth; }
    body {
      font-family: var(--font-ui);
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      transition: background var(--transition), color var(--transition);
      line-height: 1.5;
    }
    a { color: var(--accent); text-decoration: none; }
    a:hover { text-decoration: underline; }

    /* =====================================================
       SCROLLBAR
    ===================================================== */
    ::-webkit-scrollbar { width: 6px; height: 6px; }
    ::-webkit-scrollbar-track { background: var(--bg-panel); }
    ::-webkit-scrollbar-thumb { background: var(--border-light); border-radius: 3px; }

    /* =====================================================
       HEADER
    ===================================================== */
    header {
      background: var(--bg-panel);
      border-bottom: 1px solid var(--border);
      padding: 14px 24px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 16px;
      position: sticky;
      top: 0;
      z-index: 100;
      backdrop-filter: blur(10px);
    }
    .header-left { display: flex; align-items: center; gap: 12px; }
    .logo-icon {
      font-size: 22px;
      background: var(--accent-glow);
      border: 1px solid var(--accent);
      color: var(--accent);
      width: 40px; height: 40px;
      border-radius: var(--radius);
      display: flex; align-items: center; justify-content: center;
    }
    .logo-text h1 {
      font-size: 15px; font-weight: 700; letter-spacing: 0.02em;
      color: var(--text); white-space: nowrap;
    }
    .logo-text span {
      font-size: 10px; font-family: var(--font-mono);
      color: var(--text-muted); letter-spacing: 0.08em; text-transform: uppercase;
    }
    .header-right { display: flex; align-items: center; gap: 10px; }

    /* Language selector */
    .lang-select {
      font-family: var(--font-mono);
      font-size: 11px;
      background: var(--bg-card);
      border: 1px solid var(--border);
      color: var(--text);
      border-radius: var(--radius);
      padding: 5px 8px;
      cursor: pointer;
      transition: border-color var(--transition);
    }
    .lang-select:hover { border-color: var(--accent); }

    /* Dark mode toggle */
    .theme-toggle {
      display: flex; align-items: center; gap: 8px;
      font-family: var(--font-mono); font-size: 11px; color: var(--text-dim);
      cursor: pointer; user-select: none;
    }
    .toggle-switch {
      width: 40px; height: 22px;
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 11px;
      position: relative;
      transition: background var(--transition), border-color var(--transition);
      cursor: pointer;
    }
    .toggle-switch::after {
      content: '';
      position: absolute;
      width: 16px; height: 16px;
      background: var(--text-muted);
      border-radius: 50%;
      top: 2px; left: 2px;
      transition: transform 0.2s ease, background 0.2s ease;
    }
    [data-theme="light"] .toggle-switch { background: var(--accent-glow); border-color: var(--accent); }
    [data-theme="light"] .toggle-switch::after { transform: translateX(18px); background: var(--accent); }

    /* =====================================================
       MAIN LAYOUT
    ===================================================== */
    main { flex: 1; padding: 20px 24px; max-width: 1600px; margin: 0 auto; width: 100%; }

    /* Action bar */
    .action-bar {
      display: flex; align-items: center; gap: 10px;
      flex-wrap: wrap; margin-bottom: 16px;
    }
    .action-bar .preset-group {
      display: flex; align-items: center; gap: 8px;
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 6px 12px;
    }
    .action-bar .preset-group label {
      font-family: var(--font-mono); font-size: 11px; color: var(--text-muted);
      text-transform: uppercase; letter-spacing: 0.06em; white-space: nowrap;
    }
    .preset-select {
      font-family: var(--font-mono); font-size: 12px;
      background: var(--bg-input); border: 1px solid var(--border);
      color: var(--text); border-radius: 6px; padding: 4px 8px; cursor: pointer;
    }
    .btn {
      display: inline-flex; align-items: center; gap: 6px;
      padding: 8px 16px; border-radius: var(--radius);
      font-family: var(--font-mono); font-size: 12px; font-weight: 500;
      cursor: pointer; border: 1px solid var(--border);
      background: var(--bg-card); color: var(--text);
      transition: all var(--transition); white-space: nowrap;
      letter-spacing: 0.02em;
    }
    .btn:hover { border-color: var(--accent); color: var(--accent); }
    .btn.btn-primary {
      background: var(--accent); border-color: var(--accent);
      color: #000; font-weight: 700;
    }
    .btn.btn-primary:hover { background: var(--accent-dim); border-color: var(--accent-dim); }
    .btn.btn-success { border-color: var(--green); color: var(--green); }
    .btn.btn-danger { border-color: var(--red); color: var(--red); }
    .btn.btn-danger:hover { background: rgba(255,92,92,0.1); }
    .btn.copied { background: var(--green); border-color: var(--green); color: #000; }

    /* =====================================================
       WORKSPACE (textareas + sidebar)
    ===================================================== */
    .workspace {
      display: grid;
      grid-template-columns: 1fr 1fr 280px;
      gap: 16px;
      align-items: start;
    }
    @media (max-width: 1100px) {
      .workspace { grid-template-columns: 1fr 1fr; }
      .options-panel { grid-column: 1 / -1; }
    }
    @media (max-width: 700px) {
      .workspace { grid-template-columns: 1fr; }
      .options-panel { grid-column: 1; }
      .logo-text span { display: none; }
      .logo-text h1 { font-size: 13px; }
    }

    /* Textarea panels */
    .panel {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      overflow: hidden;
      display: flex; flex-direction: column;
    }
    .panel-header {
      display: flex; align-items: center; justify-content: space-between;
      padding: 10px 14px;
      background: var(--bg-panel);
      border-bottom: 1px solid var(--border);
    }
    .panel-title {
      font-family: var(--font-mono); font-size: 11px;
      color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.08em;
    }
    .panel-badge {
      font-family: var(--font-mono); font-size: 10px;
      background: var(--accent-glow); color: var(--accent);
      border: 1px solid rgba(245,166,35,0.3);
      padding: 2px 7px; border-radius: 10px;
    }
    .counter-info {
      font-family: var(--font-mono); font-size: 10px; color: var(--text-muted);
      display: flex; gap: 10px; align-items: center;
    }
    .counter-info span { display: flex; gap: 4px; align-items: center; }

    /* Numbered textarea wrapper */
    .textarea-wrapper {
      display: flex; flex: 1; position: relative;
    }
    .line-numbers {
      font-family: var(--font-mono); font-size: 12px; line-height: 21px;
      color: var(--text-muted); background: var(--bg-panel);
      border-right: 1px solid var(--border);
      padding: 12px 8px; min-width: 42px;
      text-align: right; user-select: none;
      overflow: hidden;
      white-space: pre;
    }
    textarea {
      flex: 1;
      font-family: var(--font-mono); font-size: 13px; line-height: 21px;
      background: var(--bg-input); color: var(--text);
      border: none; outline: none; resize: none;
      padding: 12px 14px;
      min-height: 360px;
      transition: background var(--transition);
    }
    textarea::placeholder { color: var(--text-muted); }
    textarea:focus { background: var(--bg-card); }
    #outputArea { cursor: default; }

    /* Stats bar */
    .stats-bar {
      display: flex; align-items: center; gap: 14px; flex-wrap: wrap;
      padding: 8px 14px;
      background: var(--bg-panel);
      border-top: 1px solid var(--border);
    }
    .stat-item {
      font-family: var(--font-mono); font-size: 11px;
      display: flex; gap: 5px; align-items: center; color: var(--text-dim);
    }
    .stat-item b { color: var(--accent); font-weight: 600; }

    /* =====================================================
       OPTIONS PANEL (sidebar)
    ===================================================== */
    .options-panel {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      overflow: hidden;
    }
    .options-panel-header {
      padding: 10px 14px;
      background: var(--bg-panel);
      border-bottom: 1px solid var(--border);
      font-family: var(--font-mono); font-size: 11px;
      color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.08em;
    }
    .options-body { padding: 14px; display: flex; flex-direction: column; gap: 14px; }
    @media (max-width: 1100px) {
      .options-body { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); }
    }

    .option-group { display: flex; flex-direction: column; gap: 6px; }
    .option-group-title {
      font-family: var(--font-mono); font-size: 10px;
      color: var(--accent); text-transform: uppercase; letter-spacing: 0.1em;
      padding-bottom: 4px;
      border-bottom: 1px solid var(--border);
    }

    label.opt-label {
      display: flex; align-items: center; gap: 7px;
      font-family: var(--font-mono); font-size: 11px; color: var(--text-dim);
      cursor: pointer; user-select: none;
    }
    label.opt-label:hover { color: var(--text); }
    label.opt-label input[type="checkbox"] {
      accent-color: var(--accent); width: 13px; height: 13px; cursor: pointer;
    }
    label.opt-label input[type="radio"] {
      accent-color: var(--accent); width: 13px; height: 13px; cursor: pointer;
    }

    .opt-input, .opt-select {
      width: 100%;
      font-family: var(--font-mono); font-size: 12px;
      background: var(--bg-input); color: var(--text);
      border: 1px solid var(--border);
      border-radius: 6px; padding: 6px 10px;
      transition: border-color var(--transition);
      outline: none;
    }
    .opt-input:focus, .opt-select:focus { border-color: var(--accent); }
    .opt-input-row {
      display: flex; gap: 6px;
    }
    .opt-input-row .opt-input { flex: 1; }
    .opt-input-row label { font-family: var(--font-mono); font-size: 10px; color: var(--text-muted); align-self: center; white-space: nowrap; }

    /* =====================================================
       HISTORY PANEL
    ===================================================== */
    .history-section {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: var(--radius-lg);
      overflow: hidden;
      margin-top: 16px;
    }
    .history-header {
      padding: 10px 14px;
      background: var(--bg-panel);
      border-bottom: 1px solid var(--border);
      display: flex; align-items: center; justify-content: space-between;
    }
    .history-header span {
      font-family: var(--font-mono); font-size: 11px;
      color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.08em;
    }
    .history-items {
      display: flex; gap: 8px; flex-wrap: wrap; padding: 10px 14px;
    }
    .history-btn {
      font-family: var(--font-mono); font-size: 11px;
      background: var(--bg-input); border: 1px solid var(--border);
      color: var(--text-dim); border-radius: 6px; padding: 5px 10px;
      cursor: pointer; transition: all var(--transition);
      display: flex; flex-direction: column; gap: 2px; text-align: left; max-width: 160px;
    }
    .history-btn:hover { border-color: var(--accent); color: var(--accent); }
    .history-btn .h-time { font-size: 9px; color: var(--text-muted); }
    .history-btn .h-preview { font-size: 11px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
    .history-empty { padding: 12px 14px; font-family: var(--font-mono); font-size: 12px; color: var(--text-muted); }

    /* =====================================================
       AD SLOT ‚Äî FOOTER
    ===================================================== */
    .ad-footer-wrap {
      background: var(--bg-panel);
      border-top: 1px solid var(--border);
      padding: 12px 24px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 6px;
    }
    .ad-label {
      font-family: var(--font-mono);
      font-size: 9px;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.1em;
    }
    .ad-placeholder {
      width: 100%;
      max-width: 728px;
      min-height: 90px;
      background: var(--bg-card);
      border: 1px dashed var(--border-light);
      border-radius: var(--radius);
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .ad-placeholder-text {
      font-family: var(--font-mono);
      font-size: 11px;
      color: var(--text-muted);
    }

    /* =====================================================
       FOOTER
    ===================================================== */
    footer {
      background: var(--bg-panel);
      border-top: 1px solid var(--border);
      padding: 14px 24px;
      display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap; gap: 8px;
      font-family: var(--font-mono); font-size: 11px; color: var(--text-muted);
    }
    footer a { color: var(--accent); }

    /* =====================================================
       TOAST NOTIFICATION
    ===================================================== */
    .toast {
      position: fixed; bottom: 24px; right: 24px;
      background: var(--bg-card); border: 1px solid var(--border);
      border-left: 3px solid var(--accent);
      color: var(--text); padding: 10px 16px;
      border-radius: var(--radius);
      font-family: var(--font-mono); font-size: 12px;
      box-shadow: var(--shadow);
      transform: translateY(80px); opacity: 0;
      transition: transform 0.25s ease, opacity 0.25s ease;
      z-index: 9999;
    }
    .toast.show { transform: translateY(0); opacity: 1; }

    /* =====================================================
       MISC
    ===================================================== */
    .separator { height: 1px; background: var(--border); }
    .hidden { display: none !important; }
    .flex-gap { display: flex; align-items: center; gap: 8px; flex-wrap: wrap; }
  </style>
</head>
<body data-theme="dark">

<!-- =====================================================
     HEADER
===================================================== -->
<header>
  <div class="header-left">
    <div class="logo-icon">:)</div>
    <div class="logo-text">
      <h1 data-i18n="appTitle">CommaHero</h1>
      <span data-i18n="appSubtitle">Column ‚Üí Delimited List ¬∑ SQL ¬∑ CSV ¬∑ Array</span>
    </div>
  </div>
  <div class="header-right">
    <select class="lang-select" id="langSelect" title="Language">
      <option value="pt">üáßüá∑ PT-BR</option>
      <option value="en">üá∫üá∏ EN</option>
      <option value="es">üá™üá∏ ES</option>
    </select>
    <label class="theme-toggle" title="Toggle dark/light mode">
      <span id="themeLabel">‚òÄÔ∏è</span>
      <div class="toggle-switch" id="themeToggle"></div>
    </label>
  </div>
</header>

<!-- =====================================================
     MAIN
===================================================== -->
<main>

  <!-- Action bar -->
  <div class="action-bar">
    <div class="preset-group">
      <label data-i18n="presets">Presets:</label>
      <select class="preset-select" id="presetSelect">
        <option value="">‚Äî <span data-i18n="selectPreset">Selecionar</span> ‚Äî</option>
        <option value="sql_in">SQL IN clause</option>
        <option value="js_array">JavaScript Array</option>
        <option value="csv_simple">CSV simples</option>
        <option value="parentheses">Valores entre par√™nteses</option>
        <option value="pipe_list">Pipe list</option>
      </select>
    </div>
    <button class="btn btn-primary" id="btnCopy">üìã <span data-i18n="copyResult">Copiar resultado</span></button>
    <button class="btn btn-success" id="btnExportTxt">‚¨á .TXT</button>
    <button class="btn btn-success" id="btnExportCsv">‚¨á .CSV</button>
    <button class="btn btn-danger" id="btnClear">üóë <span data-i18n="clearAll">Limpar tudo</span></button>
  </div>

  <!-- Workspace: input + output + options -->
  <div class="workspace">

    <!-- INPUT PANEL -->
    <div class="panel" id="inputPanel">
      <div class="panel-header">
        <span class="panel-title" data-i18n="inputLabel">Entrada ‚Äî uma linha por item</span>
        <div class="counter-info">
          <span>üìÑ <b id="lineCount">0</b> <span data-i18n="lines">linhas</span></span>
          <span>üî§ <b id="charCount">0</b> <span data-i18n="chars">chars</span></span>
        </div>
      </div>
      <div class="textarea-wrapper">
        <div class="line-numbers" id="inputLineNums"></div>
        <textarea id="inputArea" spellcheck="false" data-i18n-placeholder="inputPlaceholder"
          placeholder="Cole sua coluna de texto aqui (uma linha por item)..."></textarea>
      </div>
    </div>

    <!-- OUTPUT PANEL -->
    <div class="panel" id="outputPanel">
      <div class="panel-header">
        <span class="panel-title" data-i18n="outputLabel">Sa√≠da ‚Äî lista delimitada</span>
        <span class="panel-badge" id="outputBadge">0 itens</span>
      </div>
      <div class="textarea-wrapper">
        <div class="line-numbers" id="outputLineNums"></div>
        <textarea id="outputArea" readonly spellcheck="false"
          placeholder="O resultado aparecer√° aqui..."></textarea>
      </div>
      <div class="stats-bar">
        <div class="stat-item">‚úÖ <b id="statItems">0</b> <span data-i18n="statItemsLabel">itens gerados</span></div>
        <div class="stat-item">‚¨ú <b id="statBlanks">0</b> <span data-i18n="statBlanksLabel">linhas em branco removidas</span></div>
        <div class="stat-item">üîÅ <b id="statDupes">0</b> <span data-i18n="statDupesLabel">duplicatas removidas</span></div>
        <div class="stat-item">üìè <b id="statMaxLen">0</b> <span data-i18n="statMaxLabel">chars (maior item)</span></div>
      </div>
    </div>

    <!-- OPTIONS PANEL (sidebar) -->
    <div class="options-panel">
      <div class="options-panel-header" data-i18n="options">Op√ß√µes de Configura√ß√£o</div>
      <div class="options-body">

        <!-- Delimiter -->
        <div class="option-group">
          <div class="option-group-title" data-i18n="delimiter">Delimitador</div>
          <select class="opt-select" id="delimSelect">
            <option value=",">, ‚Äî V√≠rgula</option>
            <option value=", " selected>, ‚Äî V√≠rgula + espa√ßo</option>
            <option value=";">; ‚Äî Ponto-e-v√≠rgula</option>
            <option value="|">| ‚Äî Pipe</option>
            <option value="/">/ ‚Äî Barra</option>
            <option value="-">- ‚Äî Tra√ßo</option>
            <option value=" ">  ‚Äî Espa√ßo</option>
            <option value="custom">‚úè Outro...</option>
          </select>
          <input class="opt-input hidden" id="delimCustom" type="text" placeholder="Digite o delimitador..." maxlength="20" />
        </div>

        <!-- Prefix / Suffix -->
        <div class="option-group">
          <div class="option-group-title" data-i18n="prefixSuffix">Prefixo / Sufixo por item</div>
          <div class="opt-input-row">
            <label data-i18n="prefix">Pref.</label>
            <input class="opt-input" id="itemPrefix" type="text" placeholder="ex: '" maxlength="10" />
            <label data-i18n="suffix">Suf.</label>
            <input class="opt-input" id="itemSuffix" type="text" placeholder="ex: '" maxlength="10" />
          </div>
        </div>

        <!-- Quotes -->
        <div class="option-group">
          <div class="option-group-title" data-i18n="quotesSection">Aspas</div>
          <label class="opt-label">
            <input type="checkbox" id="quoteAll" />
            <span data-i18n="quoteAll">Colocar aspas em todos os itens</span>
          </label>
          <label class="opt-label">
            <input type="checkbox" id="quoteIfNeeded" />
            <span data-i18n="quoteIfNeeded">Aspas apenas se necess√°rio</span>
          </label>
          <label class="opt-label" id="quoteTypeRow">
            <input type="checkbox" id="quoteDouble" />
            <span data-i18n="useDoubleQuote">Usar aspas duplas (") em vez de simples (')</span>
          </label>
          <label class="opt-label">
            <input type="checkbox" id="escapeQuotes" />
            <span data-i18n="escapeQuotes">Escapar aspas internas (duplicar)</span>
          </label>
        </div>

        <!-- Cleaning -->
        <div class="option-group">
          <div class="option-group-title" data-i18n="cleaning">Limpeza</div>
          <label class="opt-label">
            <input type="checkbox" id="removeBlanks" checked />
            <span data-i18n="removeBlanks">Remover linhas em branco</span>
          </label>
          <label class="opt-label">
            <input type="checkbox" id="trimItems" checked />
            <span data-i18n="trim">Trim (remover espa√ßos extras)</span>
          </label>
          <label class="opt-label">
            <input type="checkbox" id="removeDupes" />
            <span data-i18n="removeDupes">Remover duplicatas</span>
          </label>
          <label class="opt-label" id="dupeCaseRow" style="padding-left:18px">
            <input type="checkbox" id="dupeCaseSensitive" />
            <span data-i18n="caseSensitive">Case-sensitive</span>
          </label>
        </div>

        <!-- Sort -->
        <div class="option-group">
          <div class="option-group-title" data-i18n="sorting">Ordena√ß√£o</div>
          <label class="opt-label"><input type="radio" name="sortOrder" value="none" checked /><span data-i18n="sortNone">Manter ordem original</span></label>
          <label class="opt-label"><input type="radio" name="sortOrder" value="asc" /><span data-i18n="sortAsc">Alfab√©tico A‚ÜíZ</span></label>
          <label class="opt-label"><input type="radio" name="sortOrder" value="desc" /><span data-i18n="sortDesc">Alfab√©tico Z‚ÜíA</span></label>
        </div>

        <!-- Line wrap -->
        <div class="option-group">
          <div class="option-group-title" data-i18n="lineBreak">Quebra de linha</div>
          <div class="opt-input-row">
            <label data-i18n="everyX">A cada</label>
            <input class="opt-input" id="lineBreakEvery" type="number" min="0" placeholder="‚àû" style="max-width:60px" />
            <label data-i18n="items">itens</label>
          </div>
        </div>

        <!-- Wrapping -->
        <div class="option-group">
          <div class="option-group-title" data-i18n="wrapSection">Envolt√≥rio da lista</div>
          <div class="opt-input-row">
            <label data-i18n="listPrefix">In√≠cio</label>
            <input class="opt-input" id="listPrefix" type="text" placeholder="ex: [" maxlength="20" />
            <label data-i18n="listSuffix">Fim</label>
            <input class="opt-input" id="listSuffix" type="text" placeholder="ex: ]" maxlength="20" />
          </div>
        </div>

      </div>
    </div>
  </div>

  <!-- History section -->
  <div class="history-section" id="historySection">
    <div class="history-header">
      <span data-i18n="history">Hist√≥rico recente (√∫ltimas 5 entradas)</span>
      <button class="btn" id="btnClearHistory" style="padding:4px 10px; font-size:10px;" data-i18n="clearHistory">üóë Limpar</button>
    </div>
    <div id="historyItems" class="history-items">
      <div class="history-empty" data-i18n="historyEmpty">Nenhum hist√≥rico salvo ainda.</div>
    </div>
  </div>

</main>

<!-- =====================================================
     FOOTER
===================================================== -->
<footer>
  <span>:) <strong>CommaHero.com</strong> ¬∑ 100% client-side ¬∑ Free forever</span>
  <span data-i18n="footerNote">No backend ¬∑ No login ¬∑ No tracking ¬∑ Works offline</span>
</footer>

<!-- Toast -->
<div class="toast" id="toast"></div>

<!-- =====================================================
     SCRIPT
===================================================== -->
<script>
/* =======================================================
   TRANSLATIONS (i18n)
======================================================= */
const TRANSLATIONS = {
  pt: {
    appTitle: "CommaHero",
    appSubtitle: "Coluna ‚Üí Lista Delimitada ¬∑ SQL ¬∑ CSV ¬∑ Array",
    presets: "Presets:",
    selectPreset: "Selecionar",
    copyResult: "Copiar resultado",
    clearAll: "Limpar tudo",
    clearHistory: "üóë Limpar",
    inputLabel: "Entrada ‚Äî uma linha por item",
    outputLabel: "Sa√≠da ‚Äî lista delimitada",
    lines: "linhas",
    chars: "chars",
    options: "Op√ß√µes de Configura√ß√£o",
    delimiter: "Delimitador",
    prefixSuffix: "Prefixo / Sufixo por item",
    prefix: "Pref.",
    suffix: "Suf.",
    quotesSection: "Aspas",
    quoteAll: "Colocar aspas em todos os itens",
    quoteIfNeeded: "Aspas apenas se necess√°rio",
    useDoubleQuote: "Usar aspas duplas (\") em vez de simples (')",
    escapeQuotes: "Escapar aspas internas (duplicar)",
    cleaning: "Limpeza",
    removeBlanks: "Remover linhas em branco",
    trim: "Trim (remover espa√ßos extras)",
    removeDupes: "Remover duplicatas",
    caseSensitive: "Case-sensitive",
    sorting: "Ordena√ß√£o",
    sortNone: "Manter ordem original",
    sortAsc: "Alfab√©tico A‚ÜíZ",
    sortDesc: "Alfab√©tico Z‚ÜíA",
    lineBreak: "Quebra de linha",
    everyX: "A cada",
    items: "itens",
    wrapSection: "Envolt√≥rio da lista",
    listPrefix: "In√≠cio",
    listSuffix: "Fim",
    history: "Hist√≥rico recente (√∫ltimas 5 entradas)",
    historyEmpty: "Nenhum hist√≥rico salvo ainda.",
    statItemsLabel: "itens gerados",
    statBlanksLabel: "linhas em branco removidas",
    statDupesLabel: "duplicatas removidas",
    statMaxLabel: "chars (maior item)",
    footerNote: "Sem backend ¬∑ Sem login ¬∑ Sem rastreamento ¬∑ Funciona offline",
    inputPlaceholder: "Cole sua coluna de texto aqui (uma linha por item)...",
    toastCopied: "‚úÖ Copiado para a √°rea de transfer√™ncia!",
    toastCleared: "üóë Tudo limpo!",
    toastHistoryCleared: "üóë Hist√≥rico apagado!",
    toastHistoryLoaded: "üìÇ Entrada anterior carregada!",
  },
  en: {
    appTitle: "CommaHero",
    appSubtitle: "Column ‚Üí Delimited List ¬∑ SQL ¬∑ CSV ¬∑ Array",
    presets: "Presets:",
    selectPreset: "Select",
    copyResult: "Copy result",
    clearAll: "Clear all",
    clearHistory: "üóë Clear",
    inputLabel: "Input ‚Äî one item per line",
    outputLabel: "Output ‚Äî delimited list",
    lines: "lines",
    chars: "chars",
    options: "Configuration Options",
    delimiter: "Delimiter",
    prefixSuffix: "Prefix / Suffix per item",
    prefix: "Pre.",
    suffix: "Suf.",
    quotesSection: "Quotes",
    quoteAll: "Quote all items",
    quoteIfNeeded: "Quote only when needed",
    useDoubleQuote: "Use double quotes (\") instead of single (')",
    escapeQuotes: "Escape internal quotes (double them)",
    cleaning: "Cleaning",
    removeBlanks: "Remove blank lines",
    trim: "Trim (remove extra spaces)",
    removeDupes: "Remove duplicates",
    caseSensitive: "Case-sensitive",
    sorting: "Sorting",
    sortNone: "Keep original order",
    sortAsc: "Alphabetical A‚ÜíZ",
    sortDesc: "Alphabetical Z‚ÜíA",
    lineBreak: "Line breaks",
    everyX: "Every",
    items: "items",
    wrapSection: "List wrapper",
    listPrefix: "Start",
    listSuffix: "End",
    history: "Recent history (last 5 entries)",
    historyEmpty: "No history saved yet.",
    statItemsLabel: "items generated",
    statBlanksLabel: "blank lines removed",
    statDupesLabel: "duplicates removed",
    statMaxLabel: "chars (longest item)",
    footerNote: "No backend ¬∑ No login ¬∑ No tracking ¬∑ Works offline",
    inputPlaceholder: "Paste your column of text here (one item per line)...",
    toastCopied: "‚úÖ Copied to clipboard!",
    toastCleared: "üóë Everything cleared!",
    toastHistoryCleared: "üóë History cleared!",
    toastHistoryLoaded: "üìÇ Previous entry loaded!",
  },
  es: {
    appTitle: "CommaHero",
    appSubtitle: "Columna ‚Üí Lista Delimitada ¬∑ SQL ¬∑ CSV ¬∑ Array",
    presets: "Presets:",
    selectPreset: "Seleccionar",
    copyResult: "Copiar resultado",
    clearAll: "Limpiar todo",
    clearHistory: "üóë Limpiar",
    inputLabel: "Entrada ‚Äî un elemento por l√≠nea",
    outputLabel: "Salida ‚Äî lista delimitada",
    lines: "l√≠neas",
    chars: "chars",
    options: "Opciones de configuraci√≥n",
    delimiter: "Delimitador",
    prefixSuffix: "Prefijo / Sufijo por elemento",
    prefix: "Pre.",
    suffix: "Suf.",
    quotesSection: "Comillas",
    quoteAll: "Poner comillas en todos los elementos",
    quoteIfNeeded: "Comillas solo si es necesario",
    useDoubleQuote: "Usar comillas dobles (\") en lugar de simples (')",
    escapeQuotes: "Escapar comillas internas (duplicar)",
    cleaning: "Limpieza",
    removeBlanks: "Eliminar l√≠neas en blanco",
    trim: "Trim (eliminar espacios extra)",
    removeDupes: "Eliminar duplicados",
    caseSensitive: "Distinguir may√∫sculas",
    sorting: "Ordenamiento",
    sortNone: "Mantener orden original",
    sortAsc: "Alfab√©tico A‚ÜíZ",
    sortDesc: "Alfab√©tico Z‚ÜíA",
    lineBreak: "Salto de l√≠nea",
    everyX: "Cada",
    items: "elementos",
    wrapSection: "Envoltorio de lista",
    listPrefix: "Inicio",
    listSuffix: "Fin",
    history: "Historial reciente (√∫ltimas 5 entradas)",
    historyEmpty: "A√∫n no hay historial guardado.",
    statItemsLabel: "elementos generados",
    statBlanksLabel: "l√≠neas en blanco eliminadas",
    statDupesLabel: "duplicados eliminados",
    statMaxLabel: "chars (elemento m√°s largo)",
    footerNote: "Sin backend ¬∑ Sin login ¬∑ Sin rastreo ¬∑ Funciona offline",
    inputPlaceholder: "Pegue su columna de texto aqu√≠ (un elemento por l√≠nea)...",
    toastCopied: "‚úÖ ¬°Copiado al portapapeles!",
    toastCleared: "üóë ¬°Todo limpio!",
    toastHistoryCleared: "üóë ¬°Historial borrado!",
    toastHistoryLoaded: "üìÇ ¬°Entrada anterior cargada!",
  }
};

// Detect language: saved preference > browser language > fallback pt
function detectLang() {
  const saved = localStorage.getItem('lang');
  if (saved && TRANSLATIONS[saved]) return saved;
  const browser = (navigator.language || navigator.userLanguage || 'pt').toLowerCase();
  if (browser.startsWith('pt')) return 'pt';
  if (browser.startsWith('es')) return 'es';
  if (browser.startsWith('en')) return 'en';
  return 'pt';
}
let currentLang = detectLang();

function t(key) {
  return (TRANSLATIONS[currentLang] && TRANSLATIONS[currentLang][key]) ||
         (TRANSLATIONS['pt'][key]) || key;
}

function applyTranslations() {
  document.querySelectorAll('[data-i18n]').forEach(el => {
    const key = el.getAttribute('data-i18n');
    el.textContent = t(key);
  });
  document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
    const key = el.getAttribute('data-i18n-placeholder');
    el.placeholder = t(key);
  });
  // Update output placeholder
  document.getElementById('outputArea').placeholder = currentLang === 'en'
    ? 'The result will appear here...'
    : currentLang === 'es'
    ? 'El resultado aparecer√° aqu√≠...'
    : 'O resultado aparecer√° aqui...';
}

/* =======================================================
   DOM REFS
======================================================= */
const inputArea      = document.getElementById('inputArea');
const outputArea     = document.getElementById('outputArea');
const inputLineNums  = document.getElementById('inputLineNums');
const outputLineNums = document.getElementById('outputLineNums');
const lineCountEl    = document.getElementById('lineCount');
const charCountEl    = document.getElementById('charCount');
const outputBadge    = document.getElementById('outputBadge');
const statItems      = document.getElementById('statItems');
const statBlanks     = document.getElementById('statBlanks');
const statDupes      = document.getElementById('statDupes');
const statMaxLen     = document.getElementById('statMaxLen');

const delimSelect    = document.getElementById('delimSelect');
const delimCustom    = document.getElementById('delimCustom');
const itemPrefix     = document.getElementById('itemPrefix');
const itemSuffix     = document.getElementById('itemSuffix');
const quoteAll       = document.getElementById('quoteAll');
const quoteIfNeeded  = document.getElementById('quoteIfNeeded');
const quoteDouble    = document.getElementById('quoteDouble');
const escapeQuotes   = document.getElementById('escapeQuotes');
const removeBlanks   = document.getElementById('removeBlanks');
const trimItems      = document.getElementById('trimItems');
const removeDupes    = document.getElementById('removeDupes');
const dupeCaseSensitive = document.getElementById('dupeCaseSensitive');
const lineBreakEvery = document.getElementById('lineBreakEvery');
const listPrefix     = document.getElementById('listPrefix');
const listSuffix     = document.getElementById('listSuffix');
const presetSelect   = document.getElementById('presetSelect');
const btnCopy        = document.getElementById('btnCopy');
const btnClear       = document.getElementById('btnClear');
const btnExportTxt   = document.getElementById('btnExportTxt');
const btnExportCsv   = document.getElementById('btnExportCsv');
const btnClearHistory = document.getElementById('btnClearHistory');
const historyItems   = document.getElementById('historyItems');
const themeToggle    = document.getElementById('themeToggle');
const themeLabel     = document.getElementById('themeLabel');
const langSelect     = document.getElementById('langSelect');
const toast          = document.getElementById('toast');

/* =======================================================
   DARK/LIGHT MODE
======================================================= */
let isDark = localStorage.getItem('theme') !== 'light';
function applyTheme() {
  document.body.setAttribute('data-theme', isDark ? 'dark' : 'light');
  themeLabel.textContent = isDark ? '‚òÄÔ∏è' : 'üåô';
}
themeToggle.addEventListener('click', () => {
  isDark = !isDark;
  localStorage.setItem('theme', isDark ? 'dark' : 'light');
  applyTheme();
});
applyTheme();

/* =======================================================
   LANGUAGE
======================================================= */
langSelect.value = currentLang;
langSelect.addEventListener('change', () => {
  currentLang = langSelect.value;
  localStorage.setItem('lang', currentLang);
  applyTranslations();
  convert();
});
applyTranslations();

/* =======================================================
   LINE NUMBERS helper
======================================================= */
function buildLineNumbers(text, el) {
  const lines = text ? text.split('\n') : [''];
  el.innerHTML = lines.map((_, i) => `${i + 1}`).join('\n');
}

function syncScroll(source, lineNumEl) {
  lineNumEl.scrollTop = source.scrollTop;
}

inputArea.addEventListener('scroll', () => syncScroll(inputArea, inputLineNums));
outputArea.addEventListener('scroll', () => syncScroll(outputArea, outputLineNums));

/* =======================================================
   SAMPLE DATA
======================================================= */
const SAMPLE = `Alice Johnson
Bob Smith
Carlos Mendez
Diana Prince
Edward Norton
Fiona Green
George Martin
Hannah Lee
Ivan Petrov
Julia Roberts`;

inputArea.value = SAMPLE;

/* =======================================================
   PRESET CONFIGS
======================================================= */
const PRESETS = {
  sql_in: {
    delim: ", ",
    prefix: "'", suffix: "'",
    quoteAll: false, quoteIfNeeded: false, quoteDouble: false,
    escapeQuotes: true,
    removeBlanks: true, trimItems: true, removeDupes: false,
    sort: 'none', lineBreak: '',
    listPrefix: '', listSuffix: ''
  },
  js_array: {
    delim: ", ",
    prefix: '"', suffix: '"',
    quoteAll: false, quoteIfNeeded: false, quoteDouble: true,
    escapeQuotes: true,
    removeBlanks: true, trimItems: true, removeDupes: false,
    sort: 'none', lineBreak: '',
    listPrefix: '[', listSuffix: ']'
  },
  csv_simple: {
    delim: ",",
    prefix: '', suffix: '',
    quoteAll: false, quoteIfNeeded: true, quoteDouble: false,
    escapeQuotes: true,
    removeBlanks: true, trimItems: true, removeDupes: false,
    sort: 'none', lineBreak: '',
    listPrefix: '', listSuffix: ''
  },
  parentheses: {
    delim: ", ",
    prefix: '(', suffix: ')',
    quoteAll: false, quoteIfNeeded: false, quoteDouble: false,
    escapeQuotes: false,
    removeBlanks: true, trimItems: true, removeDupes: false,
    sort: 'none', lineBreak: '',
    listPrefix: '', listSuffix: ''
  },
  pipe_list: {
    delim: "|",
    prefix: '', suffix: '',
    quoteAll: false, quoteIfNeeded: false, quoteDouble: false,
    escapeQuotes: false,
    removeBlanks: true, trimItems: true, removeDupes: false,
    sort: 'none', lineBreak: '',
    listPrefix: '', listSuffix: ''
  }
};

function applyPreset(name) {
  const p = PRESETS[name];
  if (!p) return;

  // delimiter
  const delimOpts = [',', ', ', ';', '|', '/', '-', ' '];
  if (delimOpts.includes(p.delim)) {
    delimSelect.value = p.delim;
    delimCustom.classList.add('hidden');
  } else {
    delimSelect.value = 'custom';
    delimCustom.value = p.delim;
    delimCustom.classList.remove('hidden');
  }

  itemPrefix.value = p.prefix;
  itemSuffix.value = p.suffix;
  quoteAll.checked = p.quoteAll;
  quoteIfNeeded.checked = p.quoteIfNeeded;
  quoteDouble.checked = p.quoteDouble;
  escapeQuotes.checked = p.escapeQuotes;
  removeBlanks.checked = p.removeBlanks;
  trimItems.checked = p.trimItems;
  removeDupes.checked = p.removeDupes;
  document.querySelector(`input[name="sortOrder"][value="${p.sort}"]`).checked = true;
  lineBreakEvery.value = p.lineBreak;
  listPrefix.value = p.listPrefix;
  listSuffix.value = p.listSuffix;

  convert();
}

presetSelect.addEventListener('change', () => {
  if (presetSelect.value) {
    applyPreset(presetSelect.value);
    presetSelect.value = '';
  }
});

/* =======================================================
   DELIMITER CUSTOM TOGGLE
======================================================= */
delimSelect.addEventListener('change', () => {
  if (delimSelect.value === 'custom') {
    delimCustom.classList.remove('hidden');
    delimCustom.focus();
  } else {
    delimCustom.classList.add('hidden');
  }
  convert();
});

/* =======================================================
   CORE CONVERSION LOGIC
======================================================= */
function getDelimiter() {
  return delimSelect.value === 'custom' ? delimCustom.value : delimSelect.value;
}

function getQuoteChar() {
  return quoteDouble.checked ? '"' : "'";
}

function shouldQuoteItem(item, delim) {
  if (quoteAll.checked) return true;
  if (quoteIfNeeded.checked) {
    const q = getQuoteChar();
    return item.includes(delim) || item.includes(' ') || item.includes(q) || item.includes(',');
  }
  return false;
}

function processItem(item) {
  const q = getQuoteChar();
  const prefix = itemPrefix.value;
  const suffix = itemSuffix.value;
  const delim = getDelimiter();

  let val = item;

  // Escape internal quotes
  if (escapeQuotes.checked) {
    val = val.split(q).join(q + q);
  }

  // Apply quotes
  if (shouldQuoteItem(item, delim)) {
    val = q + val + q;
  }

  // Apply prefix/suffix (if not already quoted, prefix/suffix override;
  // if quoted, they wrap outside)
  if (prefix || suffix) {
    // If item was quoted, prefix/suffix go outside the quotes
    if (!shouldQuoteItem(item, delim)) {
      val = prefix + val + suffix;
    } else {
      val = prefix + val + suffix;
    }
  }

  return val;
}

let _stats = { items: 0, blanks: 0, dupes: 0, maxLen: 0 };

function convert() {
  const raw = inputArea.value;
  const lines = raw.split('\n');

  let blanksRemoved = 0;
  let dupesRemoved = 0;

  // Step 1: process lines
  let items = lines.map(line => trimItems.checked ? line.trim() : line);

  // Step 2: remove blanks
  if (removeBlanks.checked) {
    const before = items.length;
    items = items.filter(line => line.length > 0);
    blanksRemoved = before - items.length;
  }

  // Step 3: remove duplicates
  if (removeDupes.checked) {
    const seen = new Set();
    const newItems = [];
    for (const item of items) {
      const key = dupeCaseSensitive.checked ? item : item.toLowerCase();
      if (!seen.has(key)) {
        seen.add(key);
        newItems.push(item);
      } else {
        dupesRemoved++;
      }
    }
    items = newItems;
  }

  // Step 4: sort
  const sortOrder = document.querySelector('input[name="sortOrder"]:checked').value;
  if (sortOrder === 'asc') {
    items.sort((a, b) => a.localeCompare(b));
  } else if (sortOrder === 'desc') {
    items.sort((a, b) => b.localeCompare(a));
  }

  // Step 5: stats
  const maxLen = items.reduce((max, item) => Math.max(max, item.length), 0);
  _stats = { items: items.length, blanks: blanksRemoved, dupes: dupesRemoved, maxLen };

  // Step 6: process each item (quotes, prefix, suffix)
  const processed = items.map(item => processItem(item));

  // Step 7: join with delimiter + line break logic
  const delim = getDelimiter();
  const breakEvery = parseInt(lineBreakEvery.value);
  let result = '';

  if (!isNaN(breakEvery) && breakEvery > 0) {
    const chunks = [];
    for (let i = 0; i < processed.length; i += breakEvery) {
      chunks.push(processed.slice(i, i + breakEvery).join(delim));
    }
    result = chunks.join('\n');
  } else {
    result = processed.join(delim);
  }

  // Step 8: list prefix/suffix
  const lp = listPrefix.value;
  const ls = listSuffix.value;
  if (lp || ls) result = lp + result + ls;

  // Update output
  outputArea.value = result;
  updateStats();
  updateCounters(raw);
  buildLineNumbers(raw, inputLineNums);
  buildLineNumbers(result, outputLineNums);

  // Auto-save to history (debounced by outer debounce)
  scheduleHistorySave();
}

/* =======================================================
   COUNTERS & STATS
======================================================= */
function updateCounters(raw) {
  const lines = raw.split('\n');
  lineCountEl.textContent = lines.length;
  charCountEl.textContent = raw.length;
}

function updateStats() {
  statItems.textContent = _stats.items;
  statBlanks.textContent = _stats.blanks;
  statDupes.textContent = _stats.dupes;
  statMaxLen.textContent = _stats.maxLen;
  outputBadge.textContent = `${_stats.items} ${t('statItemsLabel')}`;
}

/* =======================================================
   DEBOUNCE & EVENT LISTENERS
======================================================= */
let debounceTimer = null;
function debouncedConvert() {
  clearTimeout(debounceTimer);
  debounceTimer = setTimeout(convert, 300);
}

inputArea.addEventListener('input', debouncedConvert);

// All option changes trigger immediate convert
[delimCustom, itemPrefix, itemSuffix, lineBreakEvery, listPrefix, listSuffix].forEach(el => {
  el.addEventListener('input', convert);
});

[quoteAll, quoteIfNeeded, quoteDouble, escapeQuotes, removeBlanks,
 trimItems, removeDupes, dupeCaseSensitive].forEach(el => {
  el.addEventListener('change', convert);
});

document.querySelectorAll('input[name="sortOrder"]').forEach(el => {
  el.addEventListener('change', convert);
});

/* =======================================================
   BUTTONS
======================================================= */
btnCopy.addEventListener('click', async () => {
  const text = outputArea.value;
  if (!text) return;
  try {
    await navigator.clipboard.writeText(text);
  } catch {
    outputArea.select();
    document.execCommand('copy');
  }
  btnCopy.classList.add('copied');
  btnCopy.innerHTML = '‚úÖ ' + (currentLang === 'en' ? 'Copied!' : currentLang === 'es' ? '¬°Copiado!' : 'Copiado!');
  showToast(t('toastCopied'));
  setTimeout(() => {
    btnCopy.classList.remove('copied');
    btnCopy.innerHTML = 'üìã ' + t('copyResult');
  }, 2000);
});

btnClear.addEventListener('click', () => {
  inputArea.value = '';
  outputArea.value = '';
  inputLineNums.innerHTML = '1';
  outputLineNums.innerHTML = '1';
  lineCountEl.textContent = '0';
  charCountEl.textContent = '0';
  _stats = { items: 0, blanks: 0, dupes: 0, maxLen: 0 };
  updateStats();
  showToast(t('toastCleared'));
});

btnExportTxt.addEventListener('click', () => {
  downloadFile(outputArea.value, 'resultado.txt', 'text/plain');
});

btnExportCsv.addEventListener('click', () => {
  const lines = outputArea.value.split(/\r?\n/);
  const csv = 'item\n' + lines.map(line => {
    // Escape CSV
    if (line.includes(',') || line.includes('"') || line.includes('\n')) {
      return '"' + line.replace(/"/g, '""') + '"';
    }
    return line;
  }).join('\n');
  downloadFile(csv, 'resultado.csv', 'text/csv');
});

function downloadFile(content, filename, mimeType) {
  const blob = new Blob([content], { type: mimeType + ';charset=utf-8;' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url; a.download = filename;
  document.body.appendChild(a); a.click();
  setTimeout(() => { URL.revokeObjectURL(url); a.remove(); }, 1000);
}

/* =======================================================
   TOAST
======================================================= */
let toastTimer = null;
function showToast(msg) {
  toast.textContent = msg;
  toast.classList.add('show');
  clearTimeout(toastTimer);
  toastTimer = setTimeout(() => toast.classList.remove('show'), 2500);
}

/* =======================================================
   HISTORY (localStorage)
======================================================= */
const HISTORY_KEY = 'col2list_history';
const MAX_HISTORY = 5;

let historySaveTimer = null;
function scheduleHistorySave() {
  clearTimeout(historySaveTimer);
  historySaveTimer = setTimeout(saveToHistory, 1500);
}

function getCurrentConfig() {
  return {
    delim: delimSelect.value,
    delimCustom: delimCustom.value,
    prefix: itemPrefix.value,
    suffix: itemSuffix.value,
    quoteAll: quoteAll.checked,
    quoteIfNeeded: quoteIfNeeded.checked,
    quoteDouble: quoteDouble.checked,
    escapeQuotes: escapeQuotes.checked,
    removeBlanks: removeBlanks.checked,
    trimItems: trimItems.checked,
    removeDupes: removeDupes.checked,
    dupeCaseSensitive: dupeCaseSensitive.checked,
    sort: document.querySelector('input[name="sortOrder"]:checked').value,
    lineBreak: lineBreakEvery.value,
    listPrefix: listPrefix.value,
    listSuffix: listSuffix.value
  };
}

function applyConfig(cfg) {
  delimSelect.value = cfg.delim || ', ';
  delimCustom.value = cfg.delimCustom || '';
  if (cfg.delim === 'custom') delimCustom.classList.remove('hidden');
  else delimCustom.classList.add('hidden');
  itemPrefix.value = cfg.prefix || '';
  itemSuffix.value = cfg.suffix || '';
  quoteAll.checked = cfg.quoteAll || false;
  quoteIfNeeded.checked = cfg.quoteIfNeeded || false;
  quoteDouble.checked = cfg.quoteDouble || false;
  escapeQuotes.checked = cfg.escapeQuotes || false;
  removeBlanks.checked = cfg.removeBlanks !== false;
  trimItems.checked = cfg.trimItems !== false;
  removeDupes.checked = cfg.removeDupes || false;
  dupeCaseSensitive.checked = cfg.dupeCaseSensitive || false;
  const sort = cfg.sort || 'none';
  const radioEl = document.querySelector(`input[name="sortOrder"][value="${sort}"]`);
  if (radioEl) radioEl.checked = true;
  lineBreakEvery.value = cfg.lineBreak || '';
  listPrefix.value = cfg.listPrefix || '';
  listSuffix.value = cfg.listSuffix || '';
}

function saveToHistory() {
  const input = inputArea.value.trim();
  if (!input) return;

  let history = getHistory();
  const preview = input.split('\n').slice(0, 2).join(' | ').substring(0, 40) + (input.length > 40 ? '‚Ä¶' : '');
  const entry = {
    id: Date.now(),
    time: new Date().toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' }),
    preview,
    input,
    config: getCurrentConfig()
  };

  // Avoid saving identical consecutive entries
  if (history.length > 0 && history[0].input === input) return;

  history.unshift(entry);
  if (history.length > MAX_HISTORY) history = history.slice(0, MAX_HISTORY);
  localStorage.setItem(HISTORY_KEY, JSON.stringify(history));
  renderHistory();
}

function getHistory() {
  try {
    return JSON.parse(localStorage.getItem(HISTORY_KEY)) || [];
  } catch { return []; }
}

function renderHistory() {
  const history = getHistory();
  if (history.length === 0) {
    historyItems.innerHTML = `<div class="history-empty">${t('historyEmpty')}</div>`;
    return;
  }
  historyItems.innerHTML = history.map((entry, i) => `
    <button class="history-btn" data-id="${entry.id}" title="${entry.input.substring(0, 100)}">
      <span class="h-time">üìÖ ${entry.time} ¬∑ #${i + 1}</span>
      <span class="h-preview">${escHtml(entry.preview)}</span>
    </button>
  `).join('');

  historyItems.querySelectorAll('.history-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      const id = parseInt(btn.dataset.id);
      const entry = getHistory().find(e => e.id === id);
      if (entry) {
        inputArea.value = entry.input;
        applyConfig(entry.config);
        convert();
        showToast(t('toastHistoryLoaded'));
      }
    });
  });
}

function escHtml(str) {
  return str.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
}

btnClearHistory.addEventListener('click', () => {
  localStorage.removeItem(HISTORY_KEY);
  renderHistory();
  showToast(t('toastHistoryCleared'));
});

/* =======================================================
   INIT
======================================================= */
renderHistory();
convert(); // Initial conversion with sample data
</script>
</body>
</html>
